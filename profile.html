<!DOCTYPE html>
<html lang="en">
    <head>
      <!-- Global Site Tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-106872964-1"></script>
      <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments)}
            gtag('js', new Date());

            gtag('config', 'UA-106872964-1');
      </script>
        <title>Player Profile</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
        <link rel="stylesheet" href="style.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
        <!--profile page input editor script-->
        <script>
            $(document).ready(function(){
                pullUserData().then(()=>{setValues()})
                $(".submitChanges").on("click", submitData)
                $(".editInfo").on("click", toggleHidden)
            })

            var response = {
                first_name: "Jeff",
                fav_genre: "Party",
                about_me: "I have been playing board games forever. I am a total nerd.",
                past_games: [
                    {'Monopoly': 4},
                    {'Sorry': 2},
                    {'Settlers of Catan': 6}
                ]
            }

            function pullUserData(){
                var deferred = $.Deferred();
                $.ajax({
                    url: "./3plus_table_solution/player_input_decision_maker.php?action=retrievePublicProfile",
                    method: "POST",
                    dataType: "json",
                    data: {
                        fb_ID: 12345
                    },
                    success: deferred.resolve,
                })
                return deferred;
            }

            function updateUserData(){
                var deferred = $.Deferred();
                $.ajax({
                    url: "./3plus_table_solution/player_input_decision_maker.php?action=updateProfile",
                    method: "POST",
                    dataType: "json",
                    data: {
                        fb_ID: 12345,
                        first_name: $("#first_name").val(),
                        fav_genre: $("#fav_genre").val(),
                        about_me: $("#about_me").val()
                    },
                    success: deferred.resolve,
                })
                return deferred;
            }



            function submitData(){
                updateUserData().then(()=>{
                    setValues();
                    toggleHidden();
                })

            }

            function toggleHidden(){
                $("#personalInfo > p > *").toggleClass("hidden");
                $("#personalInfo > button").toggleClass("hidden");
            }

            function setValues(response){
                $(".name").text(response.first_name);
                $("#first_name").attr("value", response.first_name);
                $(".genre").text(response.fav_genre);
                $("#fav_genre option[value="+response.fav_genre+"]").attr('selected','selected');
                $(".about").text(response.about_me);
                $("#about_me").text(response.about_me);
            }
        </script>
        <style>
            .hidden {
                display: none;
            }
        </style>
    </head>
    <body class="columns_body create_event_margin ">
        <script>
            window.fbAsyncInit = function() {
                FB.init({
                    appId            : '133764540588384',
                    autoLogAppEvents : true,
                    xfbml            : true,
                    version          : 'v2.10'
                });

                FB.AppEvents.logPageView();
                FB.getLoginStatus(function(response) {
                    console.log(response);
                    statusChangeCallback(response);
                });
            };

            function statusChangeCallback(response){
                if(response.status === 'connected'){
                    console.log('Logged in and authenticated');
                    loggedIn=true;
                    testAPI();
                }else{
                    console.log('Not authenticated');
                    loggedIn=false;
                }
            }

            function checkLoginState(){
                FB.getLoginStatus(function(response) {
                    statusChangeCallback(response);
                });
            }

            function testAPI(){
              FB.api('/me?fields=name,email', function(response){
                if(response && !response.error){
                  console.log(response);
                  sendFacebookData(response);
            }
          });
        }


            (function(d, s, id){
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) {return;}
                js = d.createElement(s); js.id = id;
                js.src = "//connect.facebook.net/en_US/sdk.js";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <!--background image div-->
        <div class="create_event_background"></div>
        <div class="col-sm-12 col-md-12">
            <!--Top menu bar-->
            <div class="topnav margin_bottom col-sm-12 col-md-12" id="myTopnav">
                <a href="#home" id="home" class="col-sm-3 col-md-3">Home</a>
                <a href="#about" id="about"class="col-sm-3 col-md-3">About</a>
                <a href="#blog" id="blog" class="col-sm-3 col-md-3">Blog</a>
                <a href="#contact" id="contact" class="col-sm-3 col-md-3">Contact</a>
            </div>
            <!--title and logo-->
            <div class="col-sm-12 col-md-12">
                <div class="col-sm-2 col-md-2">
                    <img class="temp_logo display-inline" src="./imgs/temp logo.png"/>
                </div>
                <!--mobile title-->
                <div class="margin_bottom visible-xs visible-sm hidden-md col-sm-10">
                    <h1 class="font_md">Board Game Scout</h1>
                </div>
                <!--desktop title-->
                <div class="hidden-sm visible-md visible-lg col-md-8">
                    <h1 class="font_lg">Board Game Scout</h1>
                </div>
                <!--button_container-->
                <div class="button_container2 col-sm-12 col-md-12 col-md-offset-12">
                    <!--facebook_login_button-->
                    <div class="col-sm-12 col-md-12 col-md-offset-9">
                        <fb:login-button class="fb-login-button col-lg-2" data-max-rows="1" data-size="large" data-button-type="continue_with" data-show-faces="false" data-auto-logout-link="true" data-use-continue-as="false" scope="public_profile,email" onlogin="checkLoginState();">
                        </fb:login-button>
                    </div>
                </div>
            </div>
            <!--profile body-->
            <div class="col-sm-12 col-md-12">
                <!--Profile-->
                <div class="col-sm-12 col-md-8">
                    <h1 class="text-center col-sm-6 col-sm-offset-3 col-md-12">Player Profile</h1>
                    <div class="col-sm-12 col-md-5">
                        <img class="col-sm-6 col-sm-offset-3 col-md-12 col-md-offset-0" src="https://orig14.deviantart.net/919c/f/2011/359/9/0/profile_picture_by_aqsmorningview_stock-d4k81jt.jpg" alt="">
                    </div>
                    <!--Picture, Name, About INPUT-->
                    <div id="personalInfo" class="tableB profile_info_div col-sm-12 col-md-7">
                        <p>Name:
                            <span class="name"></span>
                            <input type="text" name="first_name" id="first_name" class="hidden" maxlength="30" size="10" placeholder=""><br/>
                        </p>
                        <p>Favorite Game Genre:
                            <span class="genre"></span>
                            <select name="fav_genre" id="fav_genre" class="hidden">
                                <option value="Family">Family (Monopoly, Risk, Sorry)</option>
                                <option value="Dexterity">Dexterity (Jenga, Operation, Twister)</option>
                                <option value="Party">Party (Pictionary, Cards Against Humanity)</option>
                                <option value="Abstract">Abstract (Chess, Blokus, YINSH)</option>
                                <option value="Thematic">Thematic (Dune, Twilight Imperium)</option>
                                <option value="Eurogames">Eurogames (Catan, Power Grid, Caylus)</option>
                                <option value="Wargames">Wargames (Paths of Glory, Armada, Empires In Arms)</option>
                            </select><br/>
                        </p>
                        <p>About Me:
                            <span class="about"></span>
                            <textarea type="text" name="about_me" id="about_me" class="hidden" placeholder=""></textarea><br/>
                        </p>
                        <button class="submitChanges hidden">Submit</button>
                    </div>
                    <button class="editInfo">Edit</button>
                    <!--<div class="tableB profile_info_div col-sm-12 col-md-7">-->
                        <!--<form class="form-group">-->
                            <!--<span>Name:</span>-->
                            <!--<input type="text" class="col-sm-10 col-md-10" placeholder="Full Name"/>-->
                            <!--<span class="col-md-2">About:</span>-->
                            <!--<input type="text" class="col-sm-10 col-md-10" placeholder="Tell Us About Yourself"/>-->
                            <!--<span class="col-md-2">Favorite Genre:</span>-->
                            <!--<input type="text" class="col-sm-10 col-md-10" placeholder="Favorite Genre of Games"/>-->
                        <!--</form>-->
                    <!--</div>-->
                </div>
                <!--Games Chart-->
                <div class="col-sm-12 col-md-4 margin_top">
                    <h1 class="text-left col-md-12">Games Played</h1>
                    <!--Games Played-->
                    <div class="col-sm-12 col-md-12">
                        <table class="table table-hover text-left">
                            <thead>
                                <tr>
                                    <th>Game Name</th>
                                    <th>Count</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Settlers of Catan</td>
                                    <td>55</td>
                                </tr>
                                <tr>
                                    <td>Charades</td>
                                    <td>Countless</td>
                                </tr>
                                <tr>
                                </tr>
                                    <td>Monopoly FTW!!</td>
                                    <td>9000++</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!--Bargraph of the games played-->
                </div>
                <!--footer-->
                <div class="footer padding_unset col-md-12">
                    <!--paypal_button-->
                    <div class="margin_top col-sm-12 col-md-12">
                        <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                            <input type="hidden" name="cmd" value="_s-xclick">
                            <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                            ">
                            <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                            <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </body>
</html>